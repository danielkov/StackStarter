{"ast":null,"code":"import { verify } from 'jsonwebtoken';\nexport const APP_SECRET = 'appsecret321';\nexport const getUserId = context => {\n  const {\n    authorization\n  } = context.req.headers;\n\n  if (authorization) {\n    const token = authorization.replace('Bearer ', '');\n    const verifiedToken = verify(token, APP_SECRET);\n    return verifiedToken && verifiedToken.userId;\n  }\n};","map":{"version":3,"sources":["/Users/danielkov/projects/DevStarter/prisma/utils.ts"],"names":["verify","APP_SECRET","getUserId","context","authorization","req","headers","token","replace","verifiedToken","userId"],"mappings":"AAAA,SAASA,MAAT,QAAuB,cAAvB;AAGA,OAAO,MAAMC,UAAU,GAAG,cAAnB;AAMP,OAAO,MAAMC,SAAS,GAAIC,OAAD,IAAqC;AAC5D,QAAM;AAAEC,IAAAA;AAAF,MAAoBD,OAAO,CAACE,GAAR,CAAYC,OAAtC;;AACA,MAAIF,aAAJ,EAAmB;AACjB,UAAMG,KAAK,GAAGH,aAAa,CAACI,OAAd,CAAsB,SAAtB,EAAiC,EAAjC,CAAd;AACA,UAAMC,aAAa,GAAGT,MAAM,CAACO,KAAD,EAAQN,UAAR,CAA5B;AACA,WAAOQ,aAAa,IAAIA,aAAa,CAACC,MAAtC;AACD;AACF,CAPM","sourcesContent":["import { verify } from 'jsonwebtoken';\nimport { Context } from './context';\n\nexport const APP_SECRET = 'appsecret321';\n\ninterface Token {\n  userId: string;\n}\n\nexport const getUserId = (context: Context): string | void => {\n  const { authorization } = context.req.headers;\n  if (authorization) {\n    const token = authorization.replace('Bearer ', '');\n    const verifiedToken = verify(token, APP_SECRET) as Token;\n    return verifiedToken && verifiedToken.userId;\n  }\n};\n"]},"metadata":{},"sourceType":"module"}